generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  CEO
  FINANCE_ADMIN
  SALES
  SALES_MANAGER
  PROJECT_MANAGER
  PROJECT_ENGINEER
  HR_ADMIN
  EMPLOYEE
  PROCUREMENT_ADMIN
  ASSET_ADMIN
  SYSTEM_ADMIN
}

model users {
  id            String     @id @default(uuid())
  email         String     @unique
  password_hash String
  role          UserRole
  employee_id   String? // Hapus @unique di sini
  is_active     Boolean    @default(true)
  employee      employees? @relation(fields: [employee_id], references: [id])
  created_at    DateTime   @default(now())
  updated_at    DateTime   @updatedAt
}

model employees {
  id           String   @id @default(uuid())
  full_name    String
  position     String
  hire_date    DateTime
  basic_salary Decimal
  allowances   Json
  users        users[]
}

enum MaterialStatus {
  Active
  EndOfLife
  Discontinue
}

enum MaterialLocation {
  Local
  Import
}

enum ServiceUnit {
  Jam
  Hari
}

model Material {
  id            String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  sbu           String?
  system        String?
  subsystem     String?
  components    String?
  item_name     String
  brand         String?
  owner_pn      String?           @map("owner_pn")
  vendor        String?
  status        MaterialStatus?
  location      MaterialLocation?
  cost_ori      Decimal?          @db.Decimal(14, 2)
  curr          String?           @db.VarChar(3)
  satuan        String?           @db.VarChar(50)
  cost_rp       Decimal?          @db.Decimal(14, 2)
  cost_date     DateTime          @default(now()) @db.Timestamptz(6)
  cost_validity DateTime?         @db.Timestamptz(6)
  created_at    DateTime          @default(now()) @db.Timestamptz(6)
  updated_at    DateTime          @default(now()) @db.Timestamptz(6)
}

model Service {
  id                      String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  service_name            String
  service_code            String      @unique
  item_type               String      @default("Service")
  category                String?
  unit                    ServiceUnit
  internal_cost_per_hour  Decimal?    @db.Decimal(14, 2)
  freelance_cost_per_hour Decimal?    @db.Decimal(14, 2)
  default_duration        Decimal?    @db.Decimal(10, 2)
  is_active               Boolean     @default(true)
  created_at              DateTime    @default(now()) @db.Timestamptz(6)
  updated_at              DateTime    @default(now()) @db.Timestamptz(6)
}
